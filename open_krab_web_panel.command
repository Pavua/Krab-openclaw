#!/bin/zsh
# -----------------------------------------------------------------------------
# –ë—ã—Å—Ç—Ä—ã–π –∑–∞–ø—É—Å–∫ Web-–ø–∞–Ω–µ–ª–∏ Krab –≤ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ (—á–µ—Ä–µ–∑ HTTP, –Ω–µ file://).
#
# –ß—Ç–æ –¥–µ–ª–∞–µ—Ç:
# 1) –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å API –ø–∞–Ω–µ–ª–∏ –Ω–∞ 127.0.0.1:8080.
# 2) –ï—Å–ª–∏ API –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω ‚Äî –∑–∞–ø—É—Å–∫–∞–µ—Ç hard-restart —è–¥—Ä–∞.
# 3) –û—Ç–∫—Ä—ã–≤–∞–µ—Ç –ø–∞–Ω–µ–ª—å –≤ –±—Ä–∞—É–∑–µ—Ä–µ –ø–æ URL http://127.0.0.1:8080.
# -----------------------------------------------------------------------------

set -euo pipefail

PROJECT_ROOT="/Users/pablito/Antigravity_AGENTS/–ö—Ä–∞–±"
PANEL_URL="http://127.0.0.1:8080"
HEALTH_URL="$PANEL_URL/api/health"

cd "$PROJECT_ROOT"

is_panel_alive() {
  curl -fsS --max-time 3 "$HEALTH_URL" >/dev/null 2>&1
}

echo "üåê –ü—Ä–æ–≤–µ—Ä—è—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å Web-–ø–∞–Ω–µ–ª–∏..."
if ! is_panel_alive; then
  echo "‚ö†Ô∏è –ü–∞–Ω–µ–ª—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∞. –í—ã–ø–æ–ª–Ω—è—é –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫ —è–¥—Ä–∞..."
  ./restart_core_hard.command
fi

echo "‚úÖ –û—Ç–∫—Ä—ã–≤–∞—é Krab Web Panel: $PANEL_URL"
open "$PANEL_URL"
