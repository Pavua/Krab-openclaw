# Telegram API (from my.telegram.org)
TELEGRAM_API_ID=
TELEGRAM_API_HASH=
TELEGRAM_SESSION_NAME=kraab
OWNER_USERNAME=
ALLOWED_USERS=
SUPERUSERS=

# OpenClaw Gateway
OPENCLAW_BASE_URL=http://127.0.0.1:18789
OPENCLAW_API_KEY=sk-nexus-bridge
OPENCLAW_REQUIRED_AUTH_PROVIDERS=openai-codex,google-gemini-cli,qwen-portal-auth
# OpenClaw Channels (подключаются по мере готовности)
OPENCLAW_DISCORD_BOT_TOKEN=
OPENCLAW_IMSG_CLI_PATH=/opt/homebrew/bin/imsg
# Дополнительно при необходимости:
# OPENCLAW_SLACK_BOT_TOKEN=
# OPENCLAW_SLACK_APP_TOKEN=
# OPENCLAW_SIGNAL_NUMBER=
# OPENCLAW_SIGNAL_HTTP_URL=http://127.0.0.1:18080

# Krab Voice Gateway
VOICE_GATEWAY_URL=http://127.0.0.1:8090
VOICE_GATEWAY_API_KEY=
# Krab Ear HTTP backend health endpoint
KRAB_EAR_BACKEND_URL=http://127.0.0.1:5005

# Krab Web Panel
WEB_PORT=8080
WEB_HOST=127.0.0.1
WEB_PUBLIC_BASE_URL=
WEB_API_KEY=
WEB_ASSISTANT_RATE_LIMIT_PER_MIN=30
WEB_IDEMPOTENCY_TTL_SEC=300

# LM Studio
LM_STUDIO_URL=http://192.168.0.171:1234
# Предпочтительная модель (substring match, например: mistral-7b, llama-3)
# Если не указано — загружается первая доступная LLM
LOCAL_PREFERRED_MODEL=
LOCAL_CHAT_TIMEOUT_SECONDS=900
ENABLE_LOCAL_BROWSER=0
LOCAL_STREAM_MAX_CHARS=20000
LOCAL_INCLUDE_REASONING=1
LOCAL_REASONING_MAX_CHARS=2000
LOCAL_STREAM_TOTAL_TIMEOUT_SECONDS=75
LOCAL_STREAM_SOCK_READ_TIMEOUT_SECONDS=20
LOCAL_STREAM_FALLBACK_TO_CLOUD=1
# Health-check локалки:
# light  -> лёгкий probe (/health и /), чтобы не сбивать idle-unload TTL в LM Studio
# models -> старое поведение, регулярный опрос /api/v1/models
LOCAL_HEALTH_PROBE_MODE=light
LOCAL_HEALTH_CACHE_TTL_SEC=30
LOCAL_HEALTH_FULL_SCAN_SECONDS=3600
LOCAL_VISION_ENABLED=0
LOCAL_VISION_MODEL=
LOCAL_VISION_TIMEOUT_SECONDS=90
LOCAL_VISION_MAX_TOKENS=1200
# Прогрев MLX Whisper на старте. На части macOS может вызывать краш при инициализации,
# поэтому по умолчанию выключен. Включай только если проверил стабильность на своей машине.
PERCEPTOR_AUDIO_WARMUP=0
# STT-тюнинг (Krab Ear / Perceptor)
STT_LANGUAGE=ru
STT_TEMPERATURE=0.0
STT_BEAM_SIZE=7
STT_BEST_OF=5
STT_PATIENCE=1.0
STT_CONDITION_ON_PREVIOUS_TEXT=1
STT_NO_SPEECH_THRESHOLD=0.45
STT_COMPRESSION_RATIO_THRESHOLD=2.4
# Важные термины для более точного распознавания (через запятую)
STT_HOTWORDS=OpenClaw,Krab,Gemini,Telegram,Signal,WhatsApp
# Дополнительные замены после STT (JSON-словарь: "как услышалось":"как надо")
STT_REPLACE_JSON=
# Защита от падений MLX/Metal: запуск STT в отдельном процессе.
# Рекомендуется держать включенным на macOS при нестабильном AGX.
STT_ISOLATED_WORKER=1
STT_WORKER_TIMEOUT_SECONDS=240
AUTO_REPLY_CONTEXT_TOKENS=3000
AUTO_REPLY_BUSY_NOTICE_SECONDS=12
AUTO_REPLY_STREAM_EDIT_INTERVAL_SECONDS=1.2
AUTO_REPLY_CONTINUE_ON_INCOMPLETE=1
AUTO_REPLY_MAX_NUMBERED_LIST_ITEMS=0
AUTO_REPLY_QUEUE_ENABLED=1
AUTO_REPLY_QUEUE_MAX_PER_CHAT=50
AUTO_REPLY_QUEUE_MAX_RETRIES=1
AUTO_REPLY_QUEUE_NOTIFY_POSITION=1
AUTO_REPLY_FORWARD_CONTEXT_ENABLED=1
AUTO_REPLY_SELF_PRIVATE_ENABLED=1
PYROGRAM_START_MAX_RETRIES=10
PYROGRAM_START_RETRY_DELAY_SECONDS=3

# Gemini (free->paid fallback)
# Бесплатный ключ (проект БЕЗ billing) — используется первым.
GEMINI_API_KEY_FREE=
# Платный ключ (проект С billing) — включается при исчерпании free tier.
GEMINI_API_KEY_PAID=
# Legacy-ключ (если не используешь раздельные free/paid поля)
GEMINI_API_KEY=
# Legacy-алиас для совместимости старых модулей
GOOGLE_API_KEY=
GEMINI_CHAT_MODEL=google/gemini-2.5-flash
GEMINI_THINKING_MODEL=google/gemini-2.5-flash
GEMINI_PRO_MODEL=google/gemini-3-pro-preview
GEMINI_CODING_MODEL=google/gemini-3-pro-preview
GEMINI_CHAT_MODEL_GROUP=google/gemini-2.5-flash-lite
GEMINI_CHAT_MODEL_OWNER_PRIVATE=google/gemini-2.5-flash
GEMINI_CHAT_MODEL_OWNER_PRIVATE_IMPORTANT=google/gemini-3-pro-preview
MODEL_OWNER_PRIVATE_ALWAYS_PRO=0
MODEL_CLOUD_PRIORITY_LIST=openai/gpt-4o-mini,openai/gpt-5-mini,openai/gpt-5-codex,google/gemini-2.5-flash,google/gemini-3-pro-preview,google/gemini-2.5-pro
# Sticky paid-tier:
# 1 -> после free->paid переключения остаёмся на paid (рекомендуется для стабильности);
# 0 -> после каждого успешного cloud-запроса пытаемся вернуться на free.
CLOUD_TIER_STICKY_ON_PAID=1
# Автосинк paid ключа в OpenClaw (models.providers.google.apiKey) при set_tier("paid"):
OPENCLAW_TIER_SYNC_PAID_KEY=1
OPENCLAW_TIER_SYNC_RESTART_GATEWAY=1
OPENCLAW_TIER_SYNC_COOLDOWN_SEC=30
# Brave Search (доп. web-поиск в локальных/кастомных навыках)
BRAVE_SEARCH_API_KEY=
# Legacy-имя ключа (поддерживается как fallback)
BRAVE_API_KEY=

# Model routing policy (Phase D)
MODEL_ROUTING_POLICY=free_first_hybrid
MODEL_REQUIRE_CONFIRM_EXPENSIVE=0
MODEL_ENABLE_CLOUD_REVIEW_CRITICAL=0
CLOUD_SOFT_CAP_CALLS=300
CLOUD_COST_PER_CALL_USD=0.01
LOCAL_COST_PER_CALL_USD=0.0
CLOUD_MONTHLY_BUDGET_USD=25

# Авто-сжатие истории (SummaryManager)
AUTO_SUMMARY_ENABLED=0
AUTO_SUMMARY_MIN_INTERVAL_SECONDS=900
AUTO_SUMMARY_MAX_HISTORY_CHARS=20000
MONTHLY_CALLS_FORECAST=5000
REACTION_FEEDBACK_PATH=artifacts/reaction_feedback.json
REACTION_LEARNING_ENABLED=1
REACTION_LEARNING_WEIGHT=0.35
CHAT_MOOD_ENABLED=1
CHAT_MOOD_WINDOW=120
AUTO_REACTIONS_ENABLED=1
AUTO_REACTIONS_MIN_INTERVAL_SECONDS=6

# Telegram SummaryX policy (Phase C)
SUMMARYX_ALLOWED_CHATS=

# Memory limits
MAX_RAM_GB=24

# Logging
LOG_LEVEL=INFO

# Reply timeouts (секунды)
AUTO_REPLY_TIMEOUT_SECONDS=900
THINK_TIMEOUT_SECONDS=420

# Image generation
COMFY_URL=http://127.0.0.1:8188
COMFY_WORKFLOW_PATH=ComfyUI/workflows/flux_dev_no_censorship.json
COMFY_ALT_WORKFLOW_PATH=ComfyUI/workflows/flux_uncensored_v2.json
IMAGE_DEFAULT_LOCAL_MODEL=local:flux-dev
IMAGE_DEFAULT_CLOUD_MODEL=cloud:imagen3
IMAGE_MODEL_IMAGEN3=imagen-3.0-generate-001
IMAGE_MODEL_NANO_BANANA=
IMAGE_MODEL_NANO_BANANA_PRO=
IMAGE_COST_IMAGEN3_USD=0.04
IMAGE_COST_NANO_BANANA_USD=0.03
IMAGE_COST_NANO_BANANA_PRO_USD=0.06

EMAIL_APP_PASSWORD=

LOCAL_MEMORY_MODE=smart

LOCAL_STRICT_SINGLE_MODEL=1

LOCAL_RESERVED_FREE_RAM_GB=10

LOCAL_MAX_SWAP_GB=8

LOCAL_EVICT_FOR_COMFYUI=1

# ===== Daily cost report =====
COST_DAILY_REPORT_ENABLED=1
COST_DAILY_REPORT_HOUR=23
COST_DAILY_REPORT_MINUTE=55
COST_DAILY_FORECAST_CALLS=5000
COST_DAILY_REPORT_FORMAT=brief
